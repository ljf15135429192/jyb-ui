import{j as ke}from"./index-77469a0c.js";import{u as Be}from"./useFontScale-afa8cc55.js";import{u as Ie}from"./useCssVar-9ccf4a46.js";import{Y as se,U as K,y as Ae,Z as _e,c as q,m as J,n as E,g as $e,h as U,t as H,j as Pe,u as Ne,k as Oe,v as ze,o as Le,q as je,r as We,f as ae,B as X,s as ne,J as Ee,_ as le,$ as Ve,e as He,d as De,a as Ze,W as Fe,p as ie,w as ce}from"./index-137ae4a8.js";import{u as ue}from"./use-id-7f4b502d.js";import{b as Me,c as Ue,r as pe}from"./use-route-8dafc2dc.js";import{u as qe}from"./use-refs-83704085.js";import{a as Q,o as Je,c as Ye}from"./use-touch-7ef5a55b.js";import{u as Ke,S as Xe}from"./index-0362a036.js";import{a as Qe,S as Ge}from"./index-14647d2a.js";import{A as D,y as w,u as O,N as et,e as d,L as tt,C as P,q as N,Q as de,I as at,U as nt,P as lt,j as it,v as ot,n as rt,Z as st,i as ct,D as fe,O as ut,W as dt,_ as ft,F as vt,g as bt}from"./vue-libs-9b0981d5.js";function ht(e,n,i){let h,s=0;const a=e.scrollLeft,o=i===0?1:Math.round(i*1e3/16);function f(){se(h)}function r(){e.scrollLeft+=(n-a)/o,++s<o&&(h=K(r))}return r(),f}function gt(e,n,i,h){let s,a=Ae(e);const o=a<n,f=i===0?1:Math.round(i*1e3/16),r=(n-a)/f;function T(){se(s)}function S(){a+=r,(o&&a>n||!o&&a<n)&&(a=n),_e(e,a),o&&a<n||!o&&a>n?s=K(S):h&&(s=K(h))}return S(),T}const[mt,oe]=q("tabs");var yt=D({name:mt,props:{count:J(Number),inited:Boolean,animated:Boolean,duration:J(E),swipeable:Boolean,lazyRender:Boolean,currentIndex:J(Number)},emits:["change"],setup(e,{emit:n,slots:i}){const h=w(),s=f=>n("change",f),a=()=>{var f;const r=(f=i.default)==null?void 0:f.call(i);return e.animated||e.swipeable?d(Qe,{ref:h,loop:!1,class:oe("track"),duration:+e.duration*1e3,touchable:e.swipeable,lazyRender:e.lazyRender,showIndicators:!1,onChange:s},{default:()=>[r]}):r},o=f=>{const r=h.value;r&&r.state.active!==f&&r.swipeTo(f,{immediate:!e.inited})};return O(()=>e.currentIndex,o),et(()=>{o(e.currentIndex)}),Q({swipeRef:h}),()=>d("div",{class:oe("content",{animated:e.animated||e.swipeable})},[a()])}});const[ve,p]=q("tabs"),Tt={type:$e("line"),color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:U(0),duration:U(.3),animated:Boolean,ellipsis:H,swipeable:Boolean,scrollspy:Boolean,offsetTop:U(0),background:String,lazyRender:H,showHeader:H,lineWidth:E,lineHeight:E,beforeChange:Function,swipeThreshold:U(5),titleActiveColor:String,titleInactiveColor:String},be=Symbol(ve);var wt=D({name:ve,props:Tt,emits:["change","scroll","rendered","clickTab","update:active"],setup(e,{emit:n,slots:i}){let h,s,a,o,f;const r=w(),T=w(),S=w(),_=w(),A=ue(),x=Pe(r),[b,m]=qe(),{children:u,linkChildren:B}=Ne(be),v=tt({inited:!1,position:"",lineStyle:{},currentIndex:-1}),z=P(()=>u.length>+e.swipeThreshold||!e.ellipsis||e.shrink),W=P(()=>({borderColor:e.color,background:e.background})),g=(t,l)=>{var c;return(c=t.name)!=null?c:l},y=P(()=>{const t=u[v.currentIndex];if(t)return g(t,v.currentIndex)}),I=P(()=>Oe(e.offsetTop)),L=P(()=>e.sticky?I.value+h:0),V=t=>{const l=T.value,c=b.value;if(!z.value||!l||!c||!c[v.currentIndex])return;const R=c[v.currentIndex].$el,C=R.offsetLeft-(l.offsetWidth-R.offsetWidth)/2;o&&o(),o=ht(l,C,t?0:+e.duration)},$=()=>{const t=v.inited;N(()=>{const l=b.value;if(!l||!l[v.currentIndex]||e.type!=="line"||We(r.value))return;const c=l[v.currentIndex].$el,{lineWidth:R,lineHeight:C}=e,k=c.offsetLeft+c.offsetWidth/2,j={width:ae(R),backgroundColor:e.color,transform:`translateX(${k}px) translateX(-50%)`};if(t&&(j.transitionDuration=`${e.duration}s`),X(C)){const M=ae(C);j.height=M,j.borderRadius=M}v.lineStyle=j})},ge=t=>{const l=t<v.currentIndex?-1:1;for(;t>=0&&t<u.length;){if(!u[t].disabled)return t;t+=l}},Z=(t,l)=>{const c=ge(t);if(!X(c))return;const R=u[c],C=g(R,c),k=v.currentIndex!==null;v.currentIndex!==c&&(v.currentIndex=c,l||V(),$()),C!==e.active&&(n("update:active",C),k&&n("change",C,R.title)),a&&!e.scrollspy&&Ee(Math.ceil(le(r.value)-I.value))},F=(t,l)=>{const c=u.find((C,k)=>g(C,k)===t),R=c?u.indexOf(c):0;Z(R,l)},G=(t=!1)=>{if(e.scrollspy){const l=u[v.currentIndex].$el;if(l&&x.value){const c=le(l,x.value)-L.value;s=!0,f&&f(),f=gt(x.value,c,t?0:+e.duration,()=>{s=!1})}}},me=(t,l,c)=>{const{title:R,disabled:C}=u[l],k=g(u[l],l);C||(Ye(e.beforeChange,{args:[k],done:()=>{Z(l),G()}}),Ue(t)),n("clickTab",{name:k,title:R,event:c,disabled:C})},ye=t=>{a=t.isFixed,n("scroll",t)},Te=t=>{N(()=>{F(t),G(!0)})},we=()=>{for(let t=0;t<u.length;t++){const{top:l}=ne(u[t].$el);if(l>L.value)return t===0?0:t-1}return u.length-1},Ce=()=>{if(e.scrollspy&&!s){const t=we();Z(t)}},Se=()=>{if(e.type==="line"&&u.length)return d("div",{class:p("line"),style:v.lineStyle},null)},ee=()=>{var t,l,c;const{type:R,border:C,sticky:k}=e,j=[d("div",{ref:k?void 0:S,class:[p("wrap"),{[Me]:R==="line"&&C}]},[d("div",{ref:T,role:"tablist",class:p("nav",[R,{shrink:e.shrink,complete:z.value}]),style:W.value,"aria-orientation":"horizontal"},[(t=i["nav-left"])==null?void 0:t.call(i),u.map(M=>M.renderTitle(me)),Se(),(l=i["nav-right"])==null?void 0:l.call(i)])]),(c=i["nav-bottom"])==null?void 0:c.call(i)];return k?d("div",{ref:S},[j]):j},te=()=>{$(),N(()=>{var t,l;V(!0),(l=(t=_.value)==null?void 0:t.swipeRef.value)==null||l.resize()})};O(()=>[e.color,e.duration,e.lineWidth,e.lineHeight],$),O(ze,te),O(()=>e.active,t=>{t!==y.value&&F(t)}),O(()=>u.length,()=>{v.inited&&(F(e.active),$(),N(()=>{V(!0)}))});const Re=()=>{F(e.active,!0),N(()=>{v.inited=!0,S.value&&(h=ne(S.value).height),V(!0)})},xe=(t,l)=>n("rendered",t,l);return Q({resize:te,scrollTo:Te}),de($),Je($),Le(Re),Ke(r,$),je("scroll",Ce,{target:x,passive:!0}),B({id:A,props:e,setLine:$,scrollable:z,onRendered:xe,currentName:y,setTitleRefs:m,scrollIntoView:V}),()=>d("div",{ref:r,class:p([e.type])},[e.showHeader?e.sticky?d(Xe,{container:r.value,offsetTop:I.value,onScroll:ye},{default:()=>[ee()]}):ee():null,d(yt,{ref:_,count:u.length,inited:v.inited,animated:e.animated,duration:e.duration,swipeable:e.swipeable,lazyRender:e.lazyRender,currentIndex:v.currentIndex,onChange:Z},{default:()=>{var t;return[(t=i.default)==null?void 0:t.call(i)]}})])}});const he=Symbol(),Vt=()=>at(he,null),[Ct,re]=q("tab"),St=D({name:Ct,props:{id:String,dot:Boolean,type:String,color:String,title:String,badge:E,shrink:Boolean,isActive:Boolean,disabled:Boolean,controls:String,scrollable:Boolean,activeColor:String,inactiveColor:String,showZeroBadge:H},setup(e,{slots:n}){const i=P(()=>{const s={},{type:a,color:o,disabled:f,isActive:r,activeColor:T,inactiveColor:S}=e;o&&a==="card"&&(s.borderColor=o,f||(r?s.backgroundColor=o:s.color=o));const A=r?T:S;return A&&(s.color=A),s}),h=()=>{const s=d("span",{class:re("text",{ellipsis:!e.scrollable})},[n.title?n.title():e.title]);return e.dot||X(e.badge)&&e.badge!==""?d(Ve,{dot:e.dot,content:e.badge,showZero:e.showZeroBadge},{default:()=>[s]}):s};return()=>d("div",{id:e.id,role:"tab",class:[re([e.type,{grow:e.scrollable&&!e.shrink,shrink:e.shrink,active:e.isActive,disabled:e.disabled}])],style:i.value,tabindex:e.disabled?void 0:e.isActive?0:-1,"aria-selected":e.isActive,"aria-disabled":e.disabled||void 0,"aria-controls":e.controls},[h()])}}),[Rt,Y]=q("tab"),xt=He({},pe,{dot:Boolean,name:E,badge:E,title:String,disabled:Boolean,titleClass:De,titleStyle:[String,Object],showZeroBadge:H});var kt=D({name:Rt,props:xt,setup(e,{slots:n}){const i=ue(),h=w(!1),s=ut(),{parent:a,index:o}=Ze(be);if(!a)return;const f=()=>{var b;return(b=e.name)!=null?b:o.value},r=()=>{h.value=!0,a.props.lazyRender&&N(()=>{a.onRendered(f(),e.title)})},T=P(()=>{const b=f()===a.currentName.value;return b&&!h.value&&r(),b}),S=w(""),_=w("");nt(()=>{const{titleClass:b,titleStyle:m}=e;S.value=b?rt(b):"",_.value=m&&typeof m!="string"?st(ct(m)):m});const A=b=>d(St,fe({key:i,id:`${a.id}-${o.value}`,ref:a.setTitleRefs(o.value),style:_.value,class:S.value,isActive:T.value,controls:i,scrollable:a.scrollable.value,activeColor:a.props.titleActiveColor,inactiveColor:a.props.titleInactiveColor,onClick:m=>b(s.proxy,o.value,m)},ie(a.props,["type","color","shrink"]),ie(e,["dot","badge","title","disabled","showZeroBadge"])),{title:n.title}),x=w(!T.value);return O(T,b=>{b?x.value=!1:Fe(()=>{x.value=!0})}),O(()=>e.title,()=>{a.setLine(),a.scrollIntoView()}),lt(he,T),Q({id:i,renderTitle:A}),()=>{var b;const m=`${a.id}-${o.value}`,{animated:u,swipeable:B,scrollspy:v,lazyRender:z}=a.props;if(!n.default&&!u)return;const W=v||T.value;if(u||B)return d(Ge,{id:i,role:"tabpanel",class:Y("panel-wrapper",{inactive:x.value}),tabindex:T.value?0:-1,"aria-hidden":!T.value,"aria-labelledby":m},{default:()=>{var I;return[d("div",{class:Y("panel")},[(I=n.default)==null?void 0:I.call(n)])]}});const y=h.value||v||!z?(b=n.default)==null?void 0:b.call(n):null;return it(d("div",{id:i,role:"tabpanel",class:Y("panel"),tabindex:W?0:-1,"aria-labelledby":m},[y]),[[ot,W]])}}});const Bt=ce(kt),It=ce(wt),Ht=D({props:{list:Array,modelValue:Number,isRightSearch:{type:Boolean,default:!1},isBtn:{type:Boolean,default:!1},isTextAuto:{type:Boolean,default:!1},isTextActive:{type:Boolean,default:!1},showList:{type:Array,default:()=>[]},isImgDouble:{type:Boolean,default:!1}},emits:["tabChange","update:modelValue","searchChange"],setup(e,{slots:n,emit:i,attrs:h}){const{getCssVar:s}=Ie({gloal:!0}),a=w(s("--jyb-red")),{list:o,modelValue:f,isRightSearch:r,isBtn:T,isTextAuto:S,isTextActive:_}=dt(e),A=w(f.value),x=w(-1),b=w(!1),m=w([]),u=w(),B=P({get:()=>f.value||A.value||0,set:g=>{A.value=g,i("update:modelValue",g)}}),{fontClass:v}=Be({name:"jyb-tab-scale",activated:!0,watch:()=>{N(()=>{u.value=m.value[B.value].clientWidth+"px"})}});de(()=>{a.value=s("--jyb-red")});const z=w(null),W=g=>{var y;B.value=g,b.value=x.value!==g,i("tabChange",(y=e.list)==null?void 0:y[g],b.value),x.value=g};return O(()=>B.value,g=>{N(()=>{console.log("变化了"),u.value=m.value[g].clientWidth+"px",m.value[B.value]&&e.isRightSearch&&e.showList})},{immediate:!0}),ft(()=>{m.value=[]}),()=>d("div",{class:["tab",{"tab-auto":S.value,"tab-button":T.value,"tab-active":_.value},v.value]},[d(It,fe({ref:z,class:"tab-box"},h,e,{"title-active-color":a.value,color:a.value,active:B.value,"onUpdate:active":g=>B.value=g,onChange:W,"line-width":u.value}),{default:()=>{var g;return[n.default&&n.default(),(g=o.value)==null?void 0:g.map((y,I)=>d(Bt,{key:I},{title:()=>d("div",{ref:L=>m.value.push(L)},[n.title&&n.title({item:y})]),default:()=>{var L;return d(vt,null,[(!Object.prototype.hasOwnProperty.call(y,"data")||(y==null?void 0:y.data))&&n[`tab${I}`]&&((L=n[`tab${I}`])==null?void 0:L.call(n)),Object.prototype.hasOwnProperty.call(y,"data")&&!(y!=null&&y.data)&&d(ke,null,{default:()=>[bt("暂无数据")]})])}}))]}}),r.value&&d("div",{class:"tab-right--shadow"},null),r.value&&d("div",{class:"tab-right"},null)])}});export{Ht as J,Vt as u};
